<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>tidygraph and ggraph • ggraph</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="tidygraph and ggraph">
<meta property="og:description" content="ggraph">
<meta property="og:image" content="https://ggraph.data-imaginist.com/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ggraph</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">2.1.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Getting Started
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/Layouts.html">Layouts</a>
    </li>
    <li>
      <a href="../articles/Nodes.html">Nodes</a>
    </li>
    <li>
      <a href="../articles/Edges.html">Edges</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/tidygraph.html">Tidygraph interface</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    News
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li class="dropdown-header">Release notes</li>
    <li>
      <a href="https://www.data-imaginist.com/2019/1-giraffe-2-giraffe-go/" class="external-link">Version 2.0.0</a>
    </li>
    <li>
      <a href="https://www.data-imaginist.com/2017/announcing-ggraph/" class="external-link">Version 1.0.0</a>
    </li>
    <li class="divider">
    </li>
<li>
      <a href="../news/index.html">Change log</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://tidygraph.data-imaginist.com" class="external-link">tidygraph</a>
</li>
<li>
  <a href="https://github.com/thomasp85/ggraph" class="external-link">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>tidygraph and ggraph</h1>
                        <h4 data-toc-skip class="author">Thomas Lin
Pedersen</h4>
            
            <h4 data-toc-skip class="date">2024-01-29</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/thomasp85/ggraph/blob/HEAD/vignettes/tidygraph.Rmd" class="external-link"><code>vignettes/tidygraph.Rmd</code></a></small>
      <div class="hidden name"><code>tidygraph.Rmd</code></div>

    </div>

    
    
<p>Following <code>ggraph</code> v2.0 the <code>tidygraph</code> package
has been used as the central data structure. The integration goes beyond
using it as a simple background engine and has deep implications for
what you can do and how you can do it when plotting with
<code>ggraph</code>. This vignette will go into the details of the
<code>ggraph</code>/<code>tidygraph</code> relationship — buckle up…</p>
<div class="section level2">
<h2 id="supported-data-structures">Supported data structures<a class="anchor" aria-label="anchor" href="#supported-data-structures"></a>
</h2>
<p>Prior to v2 <code>ggraph</code> had two main supported data
structures, namely <code>dendrogram</code> and <code>igraph</code>. In
addition <code>hclust</code> and <code>network</code> were supported by
automatic conversion to <code>dendrogram</code> and <code>igraph</code>
respectively. Each of the two data structures had their own layouts and
under the hood two different set of functionality had to be maintained
to extract nodes and edges etc. In v2 and going forward this has been
simplified and <code>ggraph</code> now uses only <code>tbl_graph</code>
as a graph representation. This does not mean that you’re out of luck if
you’re not buying into the whole <code>tidygraph</code> idea. Every
object supported by <code>tidygraph</code> is supported directly in
<code>ggraph</code> by automatic conversion to <code>tbl_graph</code>.
This means that <code>igraph</code>, <code>dendrogram</code>,
<code>hclust</code>, and <code>network</code> is still supported in
addition to <code>data.tree</code>, <code>phylo</code>, and
<code>graph</code> as well as a number of <code>data.frame</code>,
<code>matrix</code>, and <code>list</code> representations.</p>
<p>The change has reduced internal code complexity quite a bit which
will make it easier to provide new features in future. From a user point
of view it has the benefit of simplifying the API in that
<code>ggraph</code> doesn’t really care what type of network object you
pass in - every layout and geom just works with every data structure.
Further, it simplifies how to add <code>ggraph</code> support to
additional data structures: just write an <code><a href="https://tidygraph.data-imaginist.com/reference/tbl_graph.html" class="external-link">as_tbl_graph()</a></code>
method for the class!. Due to the large support of classes and data
structures in <code>tidygraph</code> this should relatively
straightforward. If you’re developer of a package that defines a custom
network class simply export an <code><a href="https://tidygraph.data-imaginist.com/reference/tbl_graph.html" class="external-link">as_tbl_graph()</a></code> method for
the class to gain native <code>ggraph</code> (and
<code>tidygraph</code>) support, or add it directly to
<code>tidygraph</code> through a <a href="https://github.com/thomasp85/tidygraph/pulls" class="external-link">PR</a>.</p>
<p>This simplification for both me and the users have really been the
motivation for the integration of <code>tidygraph</code> but as it were
it has also allowed or instigated a number of cool new features that
will be explored below.</p>
</div>
<div class="section level2">
<h2 id="nse-in-layout-specifications">NSE in layout specifications<a class="anchor" aria-label="anchor" href="#nse-in-layout-specifications"></a>
</h2>
<p>In <code>ggraph</code> the initiation will need to specify a layout
to use for the subsequent node and edge geoms. Many of these layouts use
different node and edge variables in their calculations e.g. a node size
or an edge weight. Prior to v2 these arguments would simply take a
string naming the respective variable to use, but following the v2
update these arguments implement Non-Standard Evaluation (NSE) in a
manner known from both <code>dplyr</code> and <code>ggplot2</code> where
it is used inside <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code> calls. Depending on whether the
argument refers to a node or edge value the provided expression will be
evaluated in the context of nodes or edges respectively. The bottomline
is that given a network such as this:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidygraph.data-imaginist.com" class="external-link">tidygraph</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/tbl_graph.html" class="external-link">as_tbl_graph</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>    from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">20</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    to <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html" class="external-link">sample</a></span><span class="op">(</span><span class="fl">5</span>, <span class="fl">20</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>    weight <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html" class="external-link">runif</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">graph</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tbl_graph: 5 nodes and 20 edges</span></span></span>
<span><span class="co"><span style="color: #949494;">## #</span></span></span>
<span><span class="co"><span style="color: #949494;">## # A directed multigraph with 1 component</span></span></span>
<span><span class="co"><span style="color: #949494;">## #</span></span></span>
<span><span class="co"><span style="color: #949494;">## # Node Data: 5 × 0 (active)</span></span></span>
<span><span class="co">## <span style="color: #949494;">#</span></span></span>
<span><span class="co"><span style="color: #949494;">## # Edge Data: 20 × 3</span></span></span>
<span><span class="co">##    from    to weight</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span>     1     2  0.207</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span>     2     1  0.594</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">3</span>     2     2  0.859</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 17 more rows</span></span></span></code></pre>
<p>Then, instead of writing:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">graph</span>, layout <span class="op">=</span> <span class="st">'fr'</span>, weights <span class="op">=</span> <span class="st">"weight"</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>You would simply write:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">graph</span>, layout <span class="op">=</span> <span class="st">'fr'</span>, weights <span class="op">=</span> <span class="va">weight</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="tidygraph_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>This change means that it is much easier to experiment with
modifications to node and edge parameters affecting layouts as it is not
necessary to modify the underlying graph but only the plotting code,
e.g.:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">graph</span>, layout <span class="op">=</span> <span class="st">'fr'</span>, weights <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="va">weight</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p><img src="tidygraph_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
<div class="section level2">
<h2 id="access-to-tidygraph-algorithms-in-ggraph-code">Access to tidygraph algorithms in ggraph code<a class="anchor" aria-label="anchor" href="#access-to-tidygraph-algorithms-in-ggraph-code"></a>
</h2>
<p>The most important improvement resulting from the integration of
<code>tidygraph</code> and <code>ggraph</code> is that
<code>tidygraph</code> algorithms are now directly usable within
<code>ggraph</code> calls. This means that it is no longer necessary to
precompute and store derived node and edge variables on the graph in
order to use them in a plot:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">graph</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/create_graphs.html" class="external-link">create_notable</a></span><span class="op">(</span><span class="st">'zachary'</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">graph</span>, layout <span class="op">=</span> <span class="st">'fr'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>size <span class="op">=</span> <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/centrality.html" class="external-link">centrality_pagerank</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'bottom'</span><span class="op">)</span></span></code></pre></div>
<p><img src="tidygraph_files/figure-html/unnamed-chunk-6-1.png" width="700"></p>
<p>here it is not necessary to first compute the pagerank centrality and
store it as a node variable in order to plot it, and if you’re
interested in looking at one of the myriad of other centrality measures
you simply change the plotting code. This feature makes it much easier
and painfree to investigate the effect of different graph measures on
your plots and is a huge benefit when iterating on your
visualisation.</p>
<p>Access to <code>tidygraph</code> is available within
<code><a href="../reference/ggraph.html">ggraph()</a></code> and <code><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes()</a></code> calls, and within
<code>facet</code> formulas. It is thus possible to use algorithms when
specifying layouts, adding aesthetics to geoms and splitting into
subplots - all areas were ease of iteration is vital:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">graph</span>, <span class="st">'matrix'</span>, sort.by <span class="op">=</span> <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/node_rank.html" class="external-link">node_rank_leafsort</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_edge_point.html">geom_edge_point</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>colour <span class="op">=</span> <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/centrality.html" class="external-link">centrality_edge_betweenness</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span>, mirror <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html" class="external-link">theme</a></span><span class="op">(</span>legend.position <span class="op">=</span> <span class="st">'bottom'</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Warning in .hclust_helper(x, control): control parameter method is deprecated.</span></span>
<span><span class="co">## Use linkage instead!</span></span></code></pre>
<p><img src="tidygraph_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ggraph.html">ggraph</a></span><span class="op">(</span><span class="va">graph</span>, <span class="st">'fr'</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_edge_link.html">geom_edge_link</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/geom_node_point.html">geom_node_point</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span> </span>
<span>  <span class="fu"><a href="../reference/facet_nodes.html">facet_nodes</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://tidygraph.data-imaginist.com/reference/group_graph.html" class="external-link">group_infomap</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p><img src="tidygraph_files/figure-html/unnamed-chunk-8-1.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by <a href="https://data-imaginist.com" class="external-link">Thomas Lin Pedersen</a>.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
